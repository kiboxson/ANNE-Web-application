<!DOCTYPE html>
<html>
<head>
    <title>Find Your Backend URL</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-box { padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 3px; }
        input { padding: 8px; margin: 5px; width: 400px; border: 1px solid #ddd; border-radius: 3px; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; font-size: 12px; }
        .url-test { margin: 10px 0; padding: 10px; border-left: 4px solid #007bff; }
    </style>
</head>
<body>
    <h1>üîç Find Your ANNE Backend URL</h1>
    
    <div class="test-box info">
        <h3>üìã Instructions:</h3>
        <p>This tool will help you find your correct backend URL. Your backend should return JSON with API information.</p>
    </div>

    <div class="test-box">
        <h3>üß™ Test Your Backend URLs</h3>
        <p>Enter your Vercel backend URL (check your Vercel dashboard):</p>
        <input type="text" id="customUrl" placeholder="https://your-backend-name.vercel.app">
        <button onclick="testCustomUrl()">Test This URL</button>
        <br><br>
        <button onclick="testCommonPatterns()">Auto-Test Common Patterns</button>
    </div>

    <div id="results" class="test-box">
        <h3>üìä Test Results</h3>
        <div id="resultContent">Click a button above to start testing...</div>
    </div>

    <div class="test-box info">
        <h3>‚úÖ What We're Looking For:</h3>
        <p>Your backend URL should return JSON like this:</p>
        <pre>{
  "message": "üöÄ ANNE Web Application Backend API",
  "status": "‚úÖ Server is running successfully",
  "version": "1.0.0",
  "endpoints": { ... }
}</pre>
    </div>

    <script>
        async function testUrl(url) {
            try {
                console.log('Testing:', url);
                const response = await fetch(url);
                const text = await response.text();
                
                // Try to parse as JSON
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    // Not JSON, probably HTML (frontend)
                    return {
                        url: url,
                        success: false,
                        type: 'html',
                        message: 'Returns HTML (likely frontend)',
                        status: response.status
                    };
                }
                
                // Check if it looks like our backend API
                if (data.message && (data.message.includes('Backend API') || data.message.includes('ANNE'))) {
                    return {
                        url: url,
                        success: true,
                        type: 'backend',
                        message: 'Backend API found!',
                        data: data,
                        status: response.status
                    };
                } else {
                    return {
                        url: url,
                        success: false,
                        type: 'unknown',
                        message: 'Returns JSON but not our backend',
                        data: data,
                        status: response.status
                    };
                }
            } catch (error) {
                return {
                    url: url,
                    success: false,
                    type: 'error',
                    message: error.message,
                    status: 0
                };
            }
        }

        async function testCustomUrl() {
            const url = document.getElementById('customUrl').value.trim();
            if (!url) {
                alert('Please enter a URL');
                return;
            }
            
            const resultDiv = document.getElementById('resultContent');
            resultDiv.innerHTML = '<div class="info">üîÑ Testing your URL...</div>';
            
            const result = await testUrl(url);
            displayResult(result);
        }

        async function testCommonPatterns() {
            const resultDiv = document.getElementById('resultContent');
            resultDiv.innerHTML = '<div class="info">üîÑ Testing common URL patterns...</div>';
            
            // Based on your repository name, these are likely patterns
            const patterns = [
                'https://anne-web-application-backend.vercel.app',
                'https://web-application-backend.vercel.app',
                'https://anne-backend.vercel.app',
                'https://kiboxson-anne-backend.vercel.app',
                'https://backend-anne.vercel.app',
                'https://anne-api.vercel.app',
                'https://web-application-api.vercel.app'
            ];
            
            let results = '<h4>üß™ Testing Common Patterns:</h4>';
            let foundBackend = false;
            
            for (const url of patterns) {
                const result = await testUrl(url);
                results += formatResult(result);
                
                if (result.success) {
                    foundBackend = true;
                    document.getElementById('customUrl').value = url;
                }
            }
            
            if (!foundBackend) {
                results += '<div class="error">‚ùå No backend found with common patterns. Check your Vercel dashboard for the exact URL.</div>';
            }
            
            resultDiv.innerHTML = results;
        }

        function displayResult(result) {
            const resultDiv = document.getElementById('resultContent');
            resultDiv.innerHTML = formatResult(result);
        }

        function formatResult(result) {
            if (result.success) {
                return `
                    <div class="success">
                        <h4>‚úÖ Backend Found!</h4>
                        <p><strong>URL:</strong> ${result.url}</p>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Response:</strong></p>
                        <pre>${JSON.stringify(result.data, null, 2)}</pre>
                        <p><strong>üéØ Next Step:</strong> Copy this URL to your .env.production file!</p>
                    </div>
                `;
            } else {
                const className = result.type === 'html' ? 'info' : 'error';
                return `
                    <div class="${className}">
                        <h4>${result.type === 'html' ? 'üåê' : '‚ùå'} ${result.url}</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Result:</strong> ${result.message}</p>
                        ${result.data ? `<pre>${JSON.stringify(result.data, null, 2)}</pre>` : ''}
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
